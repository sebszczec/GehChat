<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GehChat - Dokumentacja Komunikacji</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        h3 {
            color: #764ba2;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .diagram {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 30px;
            margin: 25px 0;
            overflow-x: auto;
        }
        
        .flow-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .flow-step {
            display: flex;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 800px;
        }
        
        .flow-box {
            flex: 1;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .flow-box:hover {
            transform: translateY(-5px);
        }
        
        .client-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .server-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .message-box {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .arrow {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .message-flow {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 15px;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .message-label {
            font-weight: bold;
            color: #667eea;
        }
        
        .message-content {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
        }
        
        .architecture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .component-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .component-card:hover {
            transform: translateY(-5px);
        }
        
        .component-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .component-card ul {
            list-style-position: inside;
            line-height: 1.8;
        }
        
        .protocol-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .protocol-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .protocol-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .protocol-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .protocol-table tr:hover {
            background: #e9ecef;
        }
        
        .timeline {
            position: relative;
            padding-left: 40px;
            border-left: 3px solid #667eea;
            margin: 30px 0;
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 30px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -47px;
            top: 0;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #667eea;
            border: 3px solid white;
            box-shadow: 0 0 0 3px #667eea;
        }
        
        .timeline-content {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .timeline-content h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .warning {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .state-diagram {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }
        
        .state {
            padding: 20px 30px;
            border-radius: 50px;
            font-weight: bold;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .state-disconnected {
            background: #dc3545;
            color: white;
        }
        
        .state-connecting {
            background: #ffc107;
            color: #333;
        }
        
        .state-joining {
            background: #17a2b8;
            color: white;
        }
        
        .state-connected {
            background: #28a745;
            color: white;
        }
        
        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .flow-step {
                flex-direction: column;
            }
            
            .arrow {
                transform: rotate(90deg);
            }
        }
        
        footer {
            background: #2d2d2d;
            color: white;
            text-align: center;
            padding: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üì± GehChat</h1>
            <p>Dokumentacja Techniczna Komunikacji Klient-Serwer</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Flutter IRC Client - Architektura i Protoko≈Çy Komunikacji</p>
        </header>
        
        <div class="content">
            <!-- PrzeglƒÖd Systemu -->
            <section class="section">
                <h2>üéØ PrzeglƒÖd Systemu</h2>
                <p>GehChat to klient IRC zbudowany w technologii Flutter, umo≈ºliwiajƒÖcy komunikacjƒô z serwerami IRC w czasie rzeczywistym. Aplikacja dzia≈Ça na platformach Android, iOS, Windows, Linux i macOS.</p>
                
                <div class="note">
                    <strong>üìå Uwaga:</strong> Aktualnie aplikacja nie posiada w≈Çasnego backendu - ≈ÇƒÖczy siƒô bezpo≈õrednio z serwerami IRC poprzez natywne po≈ÇƒÖczenia Socket. Backend jest zaplanowany do przysz≈Çej implementacji.
                </div>
                
                <h3>G≈Ç√≥wne Cechy Systemu</h3>
                <div class="architecture-grid">
                    <div class="component-card">
                        <h4>üîå Protok√≥≈Ç Komunikacji</h4>
                        <ul>
                            <li>IRC Protocol (RFC 1459)</li>
                            <li>Raw TCP Socket Connection</li>
                            <li>Port: 6667 (domy≈õlny)</li>
                            <li>Encoding: UTF-8</li>
                        </ul>
                    </div>
                    
                    <div class="component-card">
                        <h4>üì° Funkcjonalno≈õci</h4>
                        <ul>
                            <li>Czat grupowy na kana≈Çach</li>
                            <li>Prywatne wiadomo≈õci</li>
                            <li>Lista u≈ºytkownik√≥w</li>
                            <li>Powiadomienia push</li>
                        </ul>
                    </div>
                    
                    <div class="component-card">
                        <h4>üîí Bezpiecze≈Ñstwo</h4>
                        <ul>
                            <li>Brak szyfrowania (plain IRC)</li>
                            <li>TCP KeepAlive</li>
                            <li>Auto-reconnect (planowany)</li>
                            <li>Walidacja nick√≥w</li>
                        </ul>
                    </div>
                    
                    <div class="component-card">
                        <h4>üåç Wielojƒôzyczno≈õƒá</h4>
                        <ul>
                            <li>Obs≈Çuga jƒôzyk√≥w: EN, PL</li>
                            <li>Auto-detekcja locale</li>
                            <li>T≈Çumaczenia systemowe</li>
                            <li>Dynamiczne wiadomo≈õci</li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <!-- Architektura Aplikacji -->
            <section class="section">
                <h2>üèóÔ∏è Architektura Aplikacji</h2>
                
                <div class="diagram">
                    <h3 style="text-align: center; margin-bottom: 30px;">Schemat Warstw Aplikacji</h3>
                    <div class="flow-container">
                        <div class="flow-step">
                            <div class="flow-box client-box">
                                <div>
                                    <strong>UI Layer</strong><br>
                                    <span style="font-size: 0.8em;">Connection, Chat, Private Messages Screens</span>
                                </div>
                            </div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">
                                <div>
                                    <strong>State Management</strong><br>
                                    <span style="font-size: 0.8em;">ChatState (Provider Pattern)</span>
                                </div>
                            </div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">
                                <div>
                                    <strong>Service Layer</strong><br>
                                    <span style="font-size: 0.8em;">IrcService, NotificationService, Settings</span>
                                </div>
                            </div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box server-box">
                                <div>
                                    <strong>IRC Server</strong><br>
                                    <span style="font-size: 0.8em;">TCP Socket Connection (port 6667)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3>Kluczowe Komponenty</h3>
                
                <div class="component-card">
                    <h4>üì± IrcService (lib/services/irc_service.dart)</h4>
                    <p><strong>Rola:</strong> ZarzƒÖdzanie po≈ÇƒÖczeniem z serwerem IRC, obs≈Çuga protoko≈Çu</p>
                    <div class="code-block">
class IrcService {
  Socket? _socket;
  String server;    // e.g., 'slaugh.pl'
  int port;         // e.g., 6667
  String channel;   // e.g., '#vorest'
  
  // Streams dla reaktywnej komunikacji
  Stream&lt;IrcMessage&gt; messages;
  Stream&lt;List&lt;String&gt;&gt; users;
  Stream&lt;IrcConnectionState&gt; connectionState;
  
  // G≈Ç√≥wne metody
  Future&lt;void&gt; connect({String? customNickname});
  void sendMessage(String message, {String? target});
  void disconnect();
}</div>
                </div>
                
                <div class="component-card">
                    <h4>üéÆ ChatState (lib/models/chat_state.dart)</h4>
                    <p><strong>Rola:</strong> ZarzƒÖdzanie stanem aplikacji, po≈õrednik miƒôdzy UI a IrcService</p>
                    <div class="code-block">
class ChatState extends ChangeNotifier {
  final IrcService _ircService;
  
  List&lt;IrcMessage&gt; userMessages;
  Map&lt;String, List&lt;IrcMessage&gt;&gt; privateChats;
  List&lt;String&gt; users;
  IrcConnectionState connectionState;
  
  // Metody komunikacji
  Future&lt;void&gt; connectWithSettings(...);
  void sendChannelMessage(String message);
  void sendPrivateMessage(String recipient, String message);
}</div>
                </div>
            </section>
            
            <!-- Przep≈Çyw Komunikacji -->
            <section class="section">
                <h2>üîÑ Przep≈Çyw Komunikacji</h2>
                
                <h3>1. NawiƒÖzywanie Po≈ÇƒÖczenia</h3>
                <div class="diagram">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>1. U≈ºytkownik wprowadza dane</h4>
                                <p>Na ekranie ConnectionScreen u≈ºytkownik wype≈Çnia formularz:</p>
                                <ul>
                                    <li>Server: slaugh.pl</li>
                                    <li>Port: 6667</li>
                                    <li>Channel: #vorest</li>
                                    <li>Nickname: wybrany nick</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>2. Inicjalizacja Socket</h4>
                                <div class="code-block">_socket = await Socket.connect(server, port);</div>
                                <p>Tworzenie natywnego po≈ÇƒÖczenia TCP z serwerem IRC</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>3. IRC Handshake</h4>
                                <p>Klient wysy≈Ça sekwencjƒô komend IRC:</p>
                                <div class="message-flow">
                                    <div>
                                        <div class="message-label">Client ‚Üí Server</div>
                                        <div class="message-content">NICK username</div>
                                    </div>
                                    <div class="arrow">‚Üí</div>
                                    <div><em>Ustawienie nicku</em></div>
                                </div>
                                <div class="message-flow">
                                    <div>
                                        <div class="message-label">Client ‚Üí Server</div>
                                        <div class="message-content">USER username 0 * :username</div>
                                    </div>
                                    <div class="arrow">‚Üí</div>
                                    <div><em>Autoryzacja u≈ºytkownika</em></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>4. Odpowied≈∫ Serwera - MOTD</h4>
                                <div class="message-flow">
                                    <div><em>Message of the Day</em></div>
                                    <div class="arrow">‚Üê</div>
                                    <div>
                                        <div class="message-label">Server ‚Üí Client</div>
                                        <div class="message-content">:server 376 username :End of /MOTD command</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>5. Do≈ÇƒÖczanie do Kana≈Çu</h4>
                                <div class="message-flow">
                                    <div>
                                        <div class="message-label">Client ‚Üí Server</div>
                                        <div class="message-content">JOIN #channel</div>
                                    </div>
                                    <div class="arrow">‚Üí</div>
                                    <div><em>≈ªƒÖdanie do≈ÇƒÖczenia</em></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>6. Lista U≈ºytkownik√≥w</h4>
                                <div class="message-flow">
                                    <div><em>Aktywni na kanale</em></div>
                                    <div class="arrow">‚Üê</div>
                                    <div>
                                        <div class="message-label">Server ‚Üí Client</div>
                                        <div class="message-content">:server 353 user1 user2 user3</div>
                                    </div>
                                </div>
                                <div class="message-flow">
                                    <div><em>Koniec listy</em></div>
                                    <div class="arrow">‚Üê</div>
                                    <div>
                                        <div class="message-label">Server ‚Üí Client</div>
                                        <div class="message-content">:server 366 #channel :End of /NAMES</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>7. Stan: Po≈ÇƒÖczono ‚úÖ</h4>
                                <p>Stan zmienia siƒô na <strong>IrcConnectionState.connected</strong></p>
                                <p>U≈ºytkownik mo≈ºe teraz wysy≈Çaƒá i odbieraƒá wiadomo≈õci</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3>2. Wysy≈Çanie Wiadomo≈õci</h3>
                <div class="diagram">
                    <div class="flow-container">
                        <div class="flow-step">
                            <div class="flow-box client-box">U≈ºytkownik wpisuje wiadomo≈õƒá</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">ChatState.sendChannelMessage(msg)</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">IrcService.sendMessage(msg)</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box server-box">Socket: PRIVMSG #channel :message</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box server-box">Serwer IRC rozg≈Çasza do wszystkich</div>
                        </div>
                    </div>
                    
                    <div class="code-block">
// Kod wysy≈Çania wiadomo≈õci
void sendMessage(String message, {String? target}) {
  if (!_isConnected) return;
  
  final recipient = target ?? channel;
  _sendRaw('PRIVMSG $recipient :$message');
  
  // Dodaj w≈ÇasnƒÖ wiadomo≈õƒá do streamu
  _messageController.add(
    IrcMessage(
      sender: _nickname!,
      content: message,
      target: recipient,
      timestamp: DateTime.now(),
      isPrivate: target != null && target != channel,
    ),
  );
}</div>
                </div>
                
                <h3>3. Odbieranie Wiadomo≈õci</h3>
                <div class="diagram">
                    <div class="flow-container">
                        <div class="flow-step">
                            <div class="flow-box server-box">Serwer: :nick!user@host PRIVMSG #channel :Hello</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">Socket listener otrzymuje dane</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">_handleServerData() parsuje UTF-8</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">_processIrcLine() identyfikuje komendƒô</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">_handlePrivMsg() ekstraktuje dane</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">_messageController.add(IrcMessage)</div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box client-box">UI aktualizuje widok czatu</div>
                        </div>
                    </div>
                    
                    <div class="code-block">
// Parsowanie wiadomo≈õci PRIVMSG
void _handlePrivMsg(String line) {
  // Format: :nick!user@host PRIVMSG target :message
  final senderMatch = RegExp(r'^:([^!]+)').firstMatch(line);
  final sender = senderMatch.group(1)!;
  
  final parts = line.split(' ');
  final target = parts[2];
  final messageStart = line.indexOf(':', 1) + 1;
  final content = line.substring(messageStart);
  
  final isPrivate = target == _nickname;
  
  _messageController.add(
    IrcMessage(
      sender: sender,
      content: content,
      target: isPrivate ? sender : target,
      timestamp: DateTime.now(),
      isPrivate: isPrivate,
    ),
  );
}</div>
                </div>
            </section>
            
            <!-- Protok√≥≈Ç IRC -->
            <section class="section">
                <h2>üì° Protok√≥≈Ç IRC - Komendy i Odpowiedzi</h2>
                
                <h3>Komendy Wysy≈Çane przez Klienta</h3>
                <table class="protocol-table">
                    <thead>
                        <tr>
                            <th>Komenda</th>
                            <th>Format</th>
                            <th>Opis</th>
                            <th>Przyk≈Çad</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>NICK</strong></td>
                            <td>NICK nickname</td>
                            <td>Ustawienie lub zmiana nicku</td>
                            <td>NICK JohnDoe</td>
                        </tr>
                        <tr>
                            <td><strong>USER</strong></td>
                            <td>USER username 0 * :realname</td>
                            <td>Identyfikacja u≈ºytkownika</td>
                            <td>USER john 0 * :John Doe</td>
                        </tr>
                        <tr>
                            <td><strong>JOIN</strong></td>
                            <td>JOIN #channel</td>
                            <td>Do≈ÇƒÖczenie do kana≈Çu</td>
                            <td>JOIN #vorest</td>
                        </tr>
                        <tr>
                            <td><strong>PRIVMSG</strong></td>
                            <td>PRIVMSG target :message</td>
                            <td>Wys≈Çanie wiadomo≈õci</td>
                            <td>PRIVMSG #vorest :Hello!</td>
                        </tr>
                        <tr>
                            <td><strong>PART</strong></td>
                            <td>PART #channel</td>
                            <td>Opuszczenie kana≈Çu</td>
                            <td>PART #vorest</td>
                        </tr>
                        <tr>
                            <td><strong>QUIT</strong></td>
                            <td>QUIT :message</td>
                            <td>Roz≈ÇƒÖczenie z serwerem</td>
                            <td>QUIT :Goodbye</td>
                        </tr>
                        <tr>
                            <td><strong>PING</strong></td>
                            <td>PING :text</td>
                            <td>KeepAlive - test po≈ÇƒÖczenia</td>
                            <td>PING :keepalive</td>
                        </tr>
                        <tr>
                            <td><strong>PONG</strong></td>
                            <td>PONG :text</td>
                            <td>Odpowied≈∫ na PING serwera</td>
                            <td>PONG :slaugh.pl</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Odpowiedzi Serwera (Numeric Replies)</h3>
                <table class="protocol-table">
                    <thead>
                        <tr>
                            <th>Kod</th>
                            <th>Nazwa</th>
                            <th>Opis</th>
                            <th>Dzia≈Çanie Klienta</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>353</strong></td>
                            <td>RPL_NAMREPLY</td>
                            <td>Lista u≈ºytkownik√≥w na kanale</td>
                            <td>Aktualizacja listy u≈ºytkownik√≥w</td>
                        </tr>
                        <tr>
                            <td><strong>366</strong></td>
                            <td>RPL_ENDOFNAMES</td>
                            <td>Koniec listy u≈ºytkownik√≥w</td>
                            <td>Zmiana stanu na "connected"</td>
                        </tr>
                        <tr>
                            <td><strong>376</strong></td>
                            <td>RPL_ENDOFMOTD</td>
                            <td>Koniec Message of the Day</td>
                            <td>Wywo≈Çanie JOIN do kana≈Çu</td>
                        </tr>
                        <tr>
                            <td><strong>422</strong></td>
                            <td>ERR_NOMOTD</td>
                            <td>Brak MOTD</td>
                            <td>Wywo≈Çanie JOIN do kana≈Çu</td>
                        </tr>
                        <tr>
                            <td><strong>433</strong></td>
                            <td>ERR_NICKNAMEINUSE</td>
                            <td>Nick ju≈º zajƒôty</td>
                            <td>Ponowna pr√≥ba po 2s (10 razy)</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Zdarzenia w Czasie Rzeczywistym</h3>
                <table class="protocol-table">
                    <thead>
                        <tr>
                            <th>Zdarzenie</th>
                            <th>Format Serwera</th>
                            <th>Akcja Klienta</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>JOIN</strong></td>
                            <td>:nick!user@host JOIN #channel</td>
                            <td>Dodanie u≈ºytkownika do listy, pokazanie systemowego komunikatu</td>
                        </tr>
                        <tr>
                            <td><strong>PART</strong></td>
                            <td>:nick!user@host PART #channel</td>
                            <td>Usuniƒôcie u≈ºytkownika z listy, komunikat o opuszczeniu</td>
                        </tr>
                        <tr>
                            <td><strong>QUIT</strong></td>
                            <td>:nick!user@host QUIT :reason</td>
                            <td>Usuniƒôcie u≈ºytkownika ze wszystkich list</td>
                        </tr>
                        <tr>
                            <td><strong>NICK</strong></td>
                            <td>:oldnick!user@host NICK :newnick</td>
                            <td>Aktualizacja nicku w listach i prywatnych czatach</td>
                        </tr>
                        <tr>
                            <td><strong>PRIVMSG</strong></td>
                            <td>:nick!user@host PRIVMSG target :msg</td>
                            <td>Wy≈õwietlenie wiadomo≈õci, powiadomienie (je≈õli prywatna)</td>
                        </tr>
                        <tr>
                            <td><strong>PING</strong></td>
                            <td>PING :server</td>
                            <td>Automatyczna odpowied≈∫ PONG :server</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <!-- Stany Po≈ÇƒÖczenia -->
            <section class="section">
                <h2>üîÑ Stany Po≈ÇƒÖczenia</h2>
                
                <div class="state-diagram">
                    <div class="state state-disconnected">DISCONNECTED</div>
                    <div class="state state-connecting">CONNECTING</div>
                    <div class="state state-joining">JOINING_CHANNEL</div>
                    <div class="state state-connected">CONNECTED</div>
                </div>
                
                <div class="diagram">
                    <h3>Diagram Przej≈õƒá Stan√≥w</h3>
                    <div class="code-block">
enum IrcConnectionState {
  disconnected,    // Brak po≈ÇƒÖczenia
  connecting,      // NawiƒÖzywanie po≈ÇƒÖczenia Socket
  joiningChannel,  // Handshake IRC, oczekiwanie na MOTD
  connected,       // Pe≈Çne po≈ÇƒÖczenie, u≈ºytkownik na kanale
  error,           // B≈ÇƒÖd po≈ÇƒÖczenia
}</div>
                    
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>DISCONNECTED ‚Üí CONNECTING</h4>
                                <p>Trigger: <code>connect()</code> wywo≈Çane</p>
                                <p>Akcja: <code>Socket.connect(server, port)</code></p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>CONNECTING ‚Üí JOINING_CHANNEL</h4>
                                <p>Trigger: Socket po≈ÇƒÖczony</p>
                                <p>Akcja: Wys≈Çanie NICK i USER</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>JOINING_CHANNEL ‚Üí CONNECTED</h4>
                                <p>Trigger: Otrzymano 366 (End of NAMES)</p>
                                <p>Akcja: U≈ºytkownik jest na kanale, mo≈ºe czatowaƒá</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>ANY ‚Üí ERROR</h4>
                                <p>Trigger: B≈ÇƒÖd socketu, timeout, po≈ÇƒÖczenie zerwane</p>
                                <p>Akcja: Disconnect, wy≈õwietlenie b≈Çƒôdu</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4>ANY ‚Üí DISCONNECTED</h4>
                                <p>Trigger: <code>disconnect()</code> lub zamkniƒôcie aplikacji</p>
                                <p>Akcja: Wys≈Çanie QUIT, zamkniƒôcie socketu</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Obs≈Çuga B≈Çƒôd√≥w -->
            <section class="section">
                <h2>‚ö†Ô∏è Obs≈Çuga B≈Çƒôd√≥w i Edge Cases</h2>
                
                <h3>1. Nick Zajƒôty (ERR_NICKNAMEINUSE)</h3>
                <div class="component-card">
                    <h4>Strategia Retry</h4>
                    <div class="code-block">
// Mechanizm retry
if (_nicknameRetryCount < 10) {
  _nicknameRetryCount++;
  // Czekaj 2 sekundy i spr√≥buj ponownie
  Timer(Duration(seconds: 2), () {
    _sendRaw('NICK $_originalNickname');
  });
} else {
  // Po 10 pr√≥bach dodaj underscore
  final newNickname = '${_originalNickname}_';
  _sendRaw('NICK $newNickname');
}</div>
                </div>
                
                <h3>2. Utrata Po≈ÇƒÖczenia</h3>
                <div class="component-card">
                    <div class="code-block">
_socket!.listen(
  _handleServerData,
  onError: (error) {
    _isConnected = false;
    _addSystemMessage('Connection error occurred');
    _connectionStateController.add(IrcConnectionState.error);
  },
  onDone: () {
    _isConnected = false;
    _addSystemMessage('Disconnected from server');
    _connectionStateController.add(IrcConnectionState.disconnected);
  },
);</div>
                </div>
                
                <h3>3. KeepAlive PING/PONG</h3>
                <div class="component-card">
                    <h4>Automatyczne Utrzymanie Po≈ÇƒÖczenia</h4>
                    <div class="code-block">
// Timer wysy≈ÇajƒÖcy PING co 30 sekund
void _startKeepaliveTimer() {
  _keepaliveTimer = Timer.periodic(Duration(seconds: 30), (_) {
    if (_isConnected && _socket != null) {
      _sendRaw('PING :keepalive');
    }
  });
}

// Auto-odpowied≈∫ na PING serwera
if (line.startsWith('PING')) {
  final server = line.substring(5);
  _sendRaw('PONG $server');
  return;
}</div>
                </div>
                
                <div class="warning">
                    <strong>‚ö†Ô∏è Wa≈ºne Ograniczenia:</strong>
                    <ul>
                        <li>Brak szyfrowania - komunikacja w plain text</li>
                        <li>Brak automatycznego reconnect po utracie po≈ÇƒÖczenia</li>
                        <li>Nie dzia≈Ça na platformie Web (brak natywnego Socket)</li>
                        <li>Jeden kana≈Ç na raz (brak multi-channel support)</li>
                    </ul>
                </div>
            </section>
            
            <!-- Wiadomo≈õci Prywatne -->
            <section class="section">
                <h2>üí¨ Wiadomo≈õci Prywatne</h2>
                
                <div class="diagram">
                    <h3>Rozr√≥≈ºnienie Wiadomo≈õci Publicznych i Prywatnych</h3>
                    <div class="code-block">
// Sprawdzanie czy wiadomo≈õƒá jest prywatna
final isPrivate = target == _nickname;

// Dla wiadomo≈õci prywatnej:
// - target = sender (nick osoby, kt√≥ra wys≈Ça≈Ça)
// - Wiadomo≈õƒá lƒÖduje w privateChats[sender]

// Dla wiadomo≈õci publicznej:
// - target = #channel
// - Wiadomo≈õƒá lƒÖduje w g≈Ç√≥wnym userMessages</div>
                </div>
                
                <h3>Wysy≈Çanie Prywatnej Wiadomo≈õci</h3>
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="flow-box client-box">User kliknie na nick ‚Üí otwiera private chat</div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="flow-step">
                        <div class="flow-box message-box">sendPrivateMessage(recipient, message)</div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="flow-step">
                        <div class="flow-box server-box">PRIVMSG recipient :message</div>
                    </div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="flow-step">
                        <div class="flow-box message-box">Dodanie do privateChats[recipient]</div>
                    </div>
                </div>
                
                <h3>Powiadomienia Push</h3>
                <div class="info">
                    <strong>üì± System Powiadomie≈Ñ:</strong>
                    <ul>
                        <li>Aktywne tylko dla wiadomo≈õci prywatnych</li>
                        <li>Notyfikacja z nazwƒÖ nadawcy i fragmentem wiadomo≈õci</li>
                        <li>Klikniƒôcie powiadomienia otwiera private chat</li>
                        <li>Jedno trwa≈Çe powiadomienie podczas po≈ÇƒÖczenia</li>
                    </ul>
                </div>
            </section>
            
            <!-- Przysz≈Çy Backend -->
            <section class="section">
                <h2>üöÄ Planowana Architektura z Backend</h2>
                
                <div class="note">
                    <strong>üìå Status:</strong> Backend jest obecnie w fazie planowania. Poni≈ºej przedstawiono proponowanƒÖ architekturƒô.
                </div>
                
                <div class="diagram">
                    <h3>Architektura z Serwerem Po≈õredniczƒÖcym</h3>
                    <div class="flow-container">
                        <div class="flow-step">
                            <div class="flow-box client-box">
                                <strong>Flutter Client</strong><br>
                                <span style="font-size: 0.8em;">HTTP/WebSocket API</span>
                            </div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è‚¨ÜÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box message-box">
                                <strong>GehChat Backend</strong><br>
                                <span style="font-size: 0.8em;">Node.js / Python / Go</span>
                            </div>
                        </div>
                        <div class="arrow">‚¨áÔ∏è‚¨ÜÔ∏è</div>
                        <div class="flow-step">
                            <div class="flow-box server-box">
                                <strong>IRC Server(s)</strong><br>
                                <span style="font-size: 0.8em;">Multiple IRC networks</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3>Korzy≈õci z Backend</h3>
                <div class="architecture-grid">
                    <div class="component-card">
                        <h4>üîê Bezpiecze≈Ñstwo</h4>
                        <ul>
                            <li>HTTPS/WSS szyfrowanie</li>
                            <li>Autentykacja u≈ºytkownik√≥w</li>
                            <li>Rate limiting</li>
                            <li>Proxy dla IRC</li>
                        </ul>
                    </div>
                    
                    <div class="component-card">
                        <h4>üíæ Persystencja</h4>
                        <ul>
                            <li>Historia wiadomo≈õci</li>
                            <li>Zapisane ustawienia</li>
                            <li>Offline messages</li>
                            <li>Baza danych</li>
                        </ul>
                    </div>
                    
                    <div class="component-card">
                        <h4>üåê Multi-Platform</h4>
                        <ul>
                            <li>Wsparcie dla Web</li>
                            <li>Synchronizacja urzƒÖdze≈Ñ</li>
                            <li>Cloud notifications</li>
                            <li>Elastyczne API</li>
                        </ul>
                    </div>
                    
                    <div class="component-card">
                        <h4>üìä Funkcje Dodatkowe</h4>
                        <ul>
                            <li>Multi-channel support</li>
                            <li>Multiple IRC networks</li>
                            <li>File uploads</li>
                            <li>Analytics</li>
                        </ul>
                    </div>
                </div>
                
                <h3>Proponowany Stack Technologiczny Backend</h3>
                <table class="protocol-table">
                    <thead>
                        <tr>
                            <th>Warstwa</th>
                            <th>Technologia</th>
                            <th>Zastosowanie</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>API Server</strong></td>
                            <td>Node.js + Express / FastAPI</td>
                            <td>REST API, WebSocket handling</td>
                        </tr>
                        <tr>
                            <td><strong>Database</strong></td>
                            <td>PostgreSQL + Redis</td>
                            <td>Dane u≈ºytkownik√≥w, cache</td>
                        </tr>
                        <tr>
                            <td><strong>IRC Bridge</strong></td>
                            <td>node-irc / irc-framework</td>
                            <td>Po≈ÇƒÖczenia z serwerami IRC</td>
                        </tr>
                        <tr>
                            <td><strong>Authentication</strong></td>
                            <td>JWT + OAuth2</td>
                            <td>Bezpieczna autentykacja</td>
                        </tr>
                        <tr>
                            <td><strong>Storage</strong></td>
                            <td>AWS S3 / MinIO</td>
                            <td>Pliki, avatary</td>
                        </tr>
                        <tr>
                            <td><strong>Notifications</strong></td>
                            <td>Firebase Cloud Messaging</td>
                            <td>Push notifications</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <!-- Podsumowanie -->
            <section class="section">
                <h2>üìù Podsumowanie</h2>
                
                <div class="component-card">
                    <h4>Obecny Stan Systemu</h4>
                    <ul>
                        <li>‚úÖ Bezpo≈õrednie po≈ÇƒÖczenia TCP Socket z serwerami IRC</li>
                        <li>‚úÖ Pe≈Çna implementacja protoko≈Çu IRC (RFC 1459)</li>
                        <li>‚úÖ Czat grupowy i prywatne wiadomo≈õci</li>
                        <li>‚úÖ KeepAlive i obs≈Çuga zdarze≈Ñ w czasie rzeczywistym</li>
                        <li>‚úÖ Wieloplatformowo≈õƒá (Android, iOS, Desktop)</li>
                        <li>‚úÖ Dwujƒôzyczno≈õƒá (EN/PL)</li>
                        <li>‚ö†Ô∏è Brak backend - bezpo≈õrednia komunikacja z IRC</li>
                        <li>‚ö†Ô∏è Brak szyfrowania (plain IRC)</li>
                        <li>‚ö†Ô∏è Brak wsparcia dla Web (natywny Socket)</li>
                    </ul>
                </div>
                
                <div class="component-card">
                    <h4>Kluczowe Pliki ≈πr√≥d≈Çowe</h4>
                    <ul>
                        <li><code>lib/services/irc_service.dart</code> - Rdze≈Ñ komunikacji IRC</li>
                        <li><code>lib/models/chat_state.dart</code> - ZarzƒÖdzanie stanem</li>
                        <li><code>lib/screens/main_chat_screen.dart</code> - UI czatu g≈Ç√≥wnego</li>
                        <li><code>lib/screens/private_chat_screen.dart</code> - UI wiadomo≈õci prywatnych</li>
                        <li><code>lib/screens/connection_screen.dart</code> - Ekran ≈ÇƒÖczenia</li>
                        <li><code>lib/services/notification_service.dart</code> - Powiadomienia</li>
                    </ul>
                </div>
                
                <div class="info">
                    <strong>üéØ Cel Dokumentacji:</strong>
                    <p>Dokument ten przedstawia kompletnƒÖ architekturƒô komunikacji klient-serwer w aplikacji GehChat, pokazujƒÖc przep≈Çyw danych, protoko≈Çy, stany po≈ÇƒÖczenia oraz planowane rozszerzenia. Stanowi podstawƒô do przysz≈Çego rozwoju oraz onboardingu nowych deweloper√≥w.</p>
                </div>
            </section>
        </div>
        
        <footer>
            <p><strong>GehChat - Flutter IRC Client</strong></p>
            <p>Dokumentacja wygenerowana: Stycze≈Ñ 2026</p>
            <p>¬© GehChat Project</p>
        </footer>
    </div>
</body>
</html>